{"version":3,"sources":["all.js"],"names":["document","addEventListener","ele","querySelector","style","cursor","pos","top","left","x","y","mouseDownHandler","e","userSelect","scrollLeft","scrollTop","clientX","clientY","mouseMoveHandler","mouseUpHandler","dx","dy","removeProperty","removeEventListener","menuOpenBtn","linkBtn","querySelectorAll","menu","menuToggle","forEach","item","closeMenu","classList","contains","remove","add","apiPath","token","init","getProductList","getCartList","productList","productData","axios","get","then","response","data","products","renderProductList","combineProductInfo","images","id","title","toThousands","origin_price","price","str","innerHTML","productSelect","category","target","value","cartList","finalTotal","cartData","carts","product","quantity","textContent","preventDefault","addCardBtn","getAttribute","productId","productTitle","productNum","post","alert","cartId","discardAllBtn","orderInfoBtn","customerName","customerPhone","customerEmail","customerAddress","tradeWay","length","console","log","parts","toString","split","replace","join","inputs","form","constraints","姓名","presence","message","電話","minimum","Email","email","寄送地址","交易方式","nextElementSibling","errors","validate","Object","keys"],"mappings":"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","file":"all.js","sourcesContent":["// <!-- 預設 JS，請同學不要修改此處 -->\ndocument.addEventListener('DOMContentLoaded', function() {\n  const ele = document.querySelector('.recommendation-wall');\n  ele.style.cursor = 'grab';\n  let pos = { top: 0, left: 0, x: 0, y: 0 };\n  const mouseDownHandler = function(e) {\n      ele.style.cursor = 'grabbing';\n      ele.style.userSelect = 'none';\n\n      pos = {\n          left: ele.scrollLeft,\n          top: ele.scrollTop,\n          // Get the current mouse position\n          x: e.clientX,\n          y: e.clientY,\n      };\n\n      document.addEventListener('mousemove', mouseMoveHandler);\n      document.addEventListener('mouseup', mouseUpHandler);\n  };\n  const mouseMoveHandler = function(e) {\n      // How far the mouse has been moved\n      const dx = e.clientX - pos.x;\n      const dy = e.clientY - pos.y;\n\n      // Scroll the element\n      ele.scrollTop = pos.top - dy;\n      ele.scrollLeft = pos.left - dx;\n  };\n  const mouseUpHandler = function() {\n      ele.style.cursor = 'grab';\n      ele.style.removeProperty('user-select');\n\n      document.removeEventListener('mousemove', mouseMoveHandler);\n      document.removeEventListener('mouseup', mouseUpHandler);\n  };\n  // Attach the handler\n  ele.addEventListener('mousedown', mouseDownHandler);\n});\n// menu 切換\nlet menuOpenBtn = document.querySelector('.menuToggle');\nlet linkBtn = document.querySelectorAll('.topBar-menu a');\nlet menu = document.querySelector('.topBar-menu');\nmenuOpenBtn.addEventListener('click', menuToggle);\n\nlinkBtn.forEach((item) => {\n  item.addEventListener('click', closeMenu);\n})\n\nfunction menuToggle() {\n  if(menu.classList.contains('openMenu')) {\n      menu.classList.remove('openMenu');\n  }else {\n      menu.classList.add('openMenu');\n  }\n}\nfunction closeMenu() {\n  menu.classList.remove('openMenu');\n}\n// <!-- 預設 JS，請同學不要修改此處END -->\n\n\n// <!-- 載入資料庫、金鑰、環境變數 -->\nconst apiPath = \"ryanchiangfinaleaxam\";\nconst token = \"Jsbl8ongs9P32p2iKyLykEVQxcG2\";\n// <!-- 載入資料庫、金鑰、環境變數END -->\n\n\n// <!-- 初始化 -->\nfunction init(){\n  getProductList();\n  getCartList();\n}\ninit();\n// <!-- 初始化END -->\n\n\n// <!-- 一、商品列表 -->\n\n// 1-1 取得商品列表\nconst productList = document.querySelector(\".productWrap\");\nlet productData = [];\nfunction getProductList(){\n  axios.get(`https://livejs-api.hexschool.io/api/livejs/v1/customer/${apiPath}/products\n  `)\n  .then(function(response){\n      productData = response.data.products;\n      renderProductList()     \n  })\n}\n\n// 1-2 重構商品資訊組合：統一組字串\nfunction combineProductInfo(item){\n  return `\n  <li class=\"productCard\">\n      <h4 class=\"productType\">新品</h4>\n      <img src=\"${item.images}\" alt=\"\">\n      <a href=\"#\" class=\"addCardBtn\" data-id=\"${item.id}\" data-title=\"${item.title}\">加入購物車</a>\n      <h3>${item.title}</h3>\n      <del class=\"originPrice\">NT$${toThousands(item.origin_price)}</del>\n      <p class=\"nowPrice\">NT$${toThousands(item.price)}</p>\n  </li>`\n}\n\n// 1-3 渲染商品列表\nfunction renderProductList(){\n  let str = \"\";\n      productData.forEach(function(item){\n          str+=combineProductInfo(item);\n      })\n      productList.innerHTML = str;\n}\n\n// 1-4 商品列表選單切換事件\nconst productSelect = document.querySelector(\".productSelect\");\nproductSelect.addEventListener(\"change\", function(e){\n  const category = e.target.value;\n  if(category==\"全部\"){\n      renderProductList();\n      return;\n  }\n  let str = \"\";\n  productData.forEach(function(item){\n      if(item.category == category){\n          str+=combineProductInfo(item);\n      }\n  })\n  productList.innerHTML = str;\n})\n// <!-- 一、商品列表END -->\n\n\n// <!-- 二、購物車 -->\n\n// 2-1 取得購物車資料\nconst cartList = document.querySelector(\".shoppingCart-tableList\");\nconst finalTotal = document.querySelector(\".finalTotal\");\nlet cartData = [];\nfunction getCartList(){\n  axios.get(`https://livejs-api.hexschool.io/api/livejs/v1/customer/${apiPath}/carts\n  `)\n  .then(function(response){\n      cartData = response.data.carts;\n      getCartList();\n      let str = \"\";\n      cartData.forEach(function(item){\n          str+=\n              `<tr>\n                  <td>\n                      <div class=\"cardItem-title\">\n                          <img src=\"${item.product.images}\" alt=\"\">\n                          <p>${item.product.title}</p>\n                      </div>\n                  </td>\n                  <td>NT$${toThousands(item.product.origin_price)}</td>\n                  <td>${item.quantity}</td>\n                  <td>NT$${toThousands(item.product.price)}</td>\n                  <td class=\"discardBtn\">\n                      <a href=\"#\" class=\"material-icons\" data-id=\"${item.id}\" data-title=\"${item.product.title}\">\n                          clear\n                      </a>\n                  </td>\n              </tr>`\n      })\n      // 取得購物車資料\n      cartList.innerHTML = str;\n      //取得總金額\n      finalTotal.textContent = toThousands(response.data.finalTotal);\n  })\n}\n\n// 2-2 加入購物車事件\n  // 監聽對象是商品列表 productList ，再用 if 去確保點擊到按鈕 addCardBtn 才會觸發事件\n  // 因為 querySelector 只能綁單一 class；querySelectorAll 需要每顆按鈕個別綁定，資料越多越難管理，也會拖慢效能\n  // 監聽最好都寫在外層，用最外層去綁監聽，再去選擇內部的觸發點最保險\nproductList.addEventListener(\"click\", function(e){\n  // 取消默認的行為(錨點點擊後會至頂)\n  e.preventDefault(); \n  \n  // 確保點擊按鈕才會觸發\n  let addCardBtn = e.target.getAttribute(\"class\");\n      if(addCardBtn!== \"addCardBtn\") {\n      return;  // 點到按鈕以外的區塊沒有反應\n  }\n  \n  // 新增一筆 data-id 到 商品資訊組合 的按鈕<a>標籤上，並賦予 item 的 id，用 id 來回傳商品的加入購物車事件\n  // 如果加入購物車事件被觸發，productId即為商品資訊上的 data-id\n  let productId = e.target.getAttribute(\"data-id\");\n  let productTitle = e.target.getAttribute(\"data-title\"); // 額外：在 alert 帶入商品名稱\n  \n  \n  // 用 forEach 跑一次購物車資料，判斷購物車內是否已經有相同品項，如果有 item.quantity +1\n  let productNum = 1;\n  cartData.forEach(function(item){\n      if(item.product.id === productId){\n          productNum = item.quantity + 1;\n          \n      }\n  })\n  \n  // 把新增的購物車資料 post 回資料庫\n  axios.post(`https://livejs-api.hexschool.io/api/livejs/v1/customer/${apiPath}/carts`, {\n      \"data\": {\n        \"productId\": productId,\n        \"quantity\": productNum,\n      }\n    }).then(function(response){\n      \n      alert(`${productTitle} 已加入購物車`);\n      getCartList();\n    })\n})\n\n// 2-3 購物車取消事件\n// 監聽購物車清單\ncartList.addEventListener(\"click\", function(e){\n  // 取消默認的行為(錨點點擊後會至頂)\n  e.preventDefault();\n  // 用 data-id 取得觸發事件的商品 Id\n  const cartId = e.target.getAttribute(\"data-id\");\n  \n\n  // 只有按鈕能夠回傳 cartId，限定點擊按鈕，其他區域無效\n  if(cartId==null){\n      return;\n  }\n  \n  let productTitle = e.target.getAttribute(\"data-title\"); // 額外：在 alert 帶入商品名稱\n  // 連接資料庫\n  axios.delete(`https://livejs-api.hexschool.io/api/livejs/v1/customer/${apiPath}/carts/${cartId}`)\n  .then(function(response){\n      alert(`已刪除 ${productTitle}`);\n      getCartList(); // 重新渲染，整理目前資料\n  })\n})\n\n// 2-4 刪除整個購物車事件\n//監聽全部刪除按鈕\nconst discardAllBtn = document.querySelector(\".discardAllBtn\");\ndiscardAllBtn.addEventListener(\"click\", function(e){\n  e.preventDefault();\n  axios.delete(`https://livejs-api.hexschool.io/api/livejs/v1/customer/${apiPath}/carts`)\n  .then(function(response){\n      alert(`已全部刪除`);\n      getCartList(); // 重新渲染，整理目前資料\n  })\n  .catch(function(response){\n      alert(`購物車沒有東西`);\n  })\n})\n\n// <!-- 二、購物車END -->\n\n\n// <!-- 三、送出訂單 -->\nconst orderInfoBtn =  document.querySelector(\".orderInfo-btn\");\norderInfoBtn.addEventListener(\"click\", function(e){\n  e.preventDefault();\n  const customerName = document.querySelector(\"#customerName\").value;\n  const customerPhone = document.querySelector(\"#customerPhone\").value;\n  const customerEmail = document.querySelector(\"#customerEmail\").value;\n  const customerAddress = document.querySelector(\"#customerAddress\").value;\n  const tradeWay = document.querySelector(\"#tradeWay\").value;\n  if(cartData.length==0){\n      alert(\"購物車是空的\");\n      return;\n  }else if(customerName ==\"\" ||customerPhone ==\"\" ||customerEmail ==\"\" ||customerAddress ==\"\" ||tradeWay ==\"\"){\n      alert(\"資料不可以留空\");\n      return;\n  }\n\n  // post 傳回訂單資料\n  axios.post(`https://livejs-api.hexschool.io/api/livejs/v1/customer/${apiPath}/orders`,{\n      \"data\": {\n        \"user\": {\n          \"name\": customerName,\n          \"tel\": customerPhone,\n          \"email\": customerEmail,\n          \"address\": customerAddress,\n          \"payment\": tradeWay,\n        }\n      }\n    }).then(function(response){\n      alert(\"已送出訂單\");\n      // 表單回復預設值\n      document.querySelector(\"#customerName\").value=\"\";\n      document.querySelector(\"#customerPhone\").value=\"\";\n      document.querySelector(\"#customerEmail\").value=\"\";\n      document.querySelector(\"#customerAddress\").value=\"\";\n      document.querySelector(\"#tradeWay\").value=\"ATM\";\n      console.log(customerAddress)\n      getCartList();\n    })\n})\n\n// <!-- 三、送出訂單END -->\n\n\n// <!-- 套件工具 -->\n\n// 千分位工具\nfunction toThousands(x){\n  let parts = x.toString().split(\".\");\n  parts[0] = parts[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\n  return parts.join(\".\");\n}\n\n// validation 表單驗證套件\nconst inputs = document.querySelectorAll(\"input[name],select[data=payment]\");\nconst form = document.querySelector(\".orderInfo-form\");\nconst constraints = {\n  姓名: {\n    presence: {\n      message: \"必填欄位\"\n    }\n  },\n  電話: {\n    presence: {\n      message: \"必填欄位\"\n    },\n    length: {\n      minimum: 8,\n      message: \"需超過 8 碼\"\n    }\n  },\n  Email: {\n    presence: {\n      message: \"必填欄位\"\n    },\n    email: {\n      message: \"格式錯誤\"\n    }\n  },\n  寄送地址: {\n    presence: {\n      message: \"必填欄位\"\n    }\n  },\n  交易方式: {\n    presence: {\n      message: \"必填欄位\"\n    }\n  }\n};\n\ninputs.forEach((item) => {\n  item.addEventListener(\"blur\", function () {\n    item.nextElementSibling.textContent = \"\";\n    let errors = validate(form, constraints);\n    console.log(errors);\n\n    if (errors) {\n      Object.keys(errors).forEach(function (keys) {\n        // console.log(document.querySelector(`[data-message=${keys}]`))\n        document.querySelector(`[data-message=\"${keys}\"]`).textContent =\n          errors[keys];\n      });\n    }\n  });\n});\n\n// <!-- 套件工具END -->\n"]}